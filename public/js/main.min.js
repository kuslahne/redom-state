!function(){"use strict";function t(t,e){for(var n,o,i,r=0,a=0,s=0;s<=t.length;s++){var u=t.charCodeAt(s);if(u===p||u===v||!u){if(0===r)n=0===s?"div":u?t.substring(a,s):t;else{var d=t.substring(a,s);1===r?o=d:i?i+=" "+d:i=d}a=s+1,r=u===p?1:2}}var l=e?document.createElementNS(e,n):document.createElement(n);return o&&(l.id=o),i&&(e?l.setAttribute("class",i):l.className=i),l}function e(t,e,n){var r=b(t),a=b(e);e===a&&a.__redom_view&&(e=a.__redom_view),e!==a&&(a.__redom_view=e);var s=a.__redom_mounted,u=a.parentNode;return s&&u!==r&&i(e,a,u),n?r.insertBefore(a,b(n)):r.appendChild(a),o(e,a,r,u),e}function n(t,e){var n=t.el||t,o=e.el||e;return e===o&&o.__redom_view&&(e=o.__redom_view),i(e,o,n),n.removeChild(o),e}function o(t,e,n,o){for(var i=e.__redom_lifecycle||(e.__redom_lifecycle={}),a=n===o,s=!1,u=0;u<g.length;u++){var d=g[u];!a&&t!==e&&d in t&&(i[d]=(i[d]||0)+1),i[d]&&(s=!0)}if(s){var l=n,c=!1;if((a||!c&&l&&l.__redom_mounted)&&(r(e,a?"onremount":"onmount"),c=!0),!a)for(;l;){var h=l.parentNode,f=l.__redom_lifecycle||(l.__redom_lifecycle={});for(var p in i)f[p]=(f[p]||0)+i[p];!c&&(l===document||h&&h.__redom_mounted)&&(r(l,a?"onremount":"onmount"),c=!0),l=h}}}function i(t,e,n){var o=e.__redom_lifecycle;if(o){var i=n;for(e.__redom_mounted&&r(e,"onunmount");i;){var a=i.__redom_lifecycle||(i.__redom_lifecycle={}),s=!1;for(var u in o)a[u]&&(a[u]-=o[u]),a[u]&&(s=!0);s||(i.__redom_lifecycle=null),i=i.parentNode}}}function r(t,e){"onmount"===e?t.__redom_mounted=!0:"onunmount"===e&&(t.__redom_mounted=!1);var n=t.__redom_lifecycle;if(n){var o=t.__redom_view,i=0;o&&o[e]&&o[e]();for(var a in n)a&&i++;if(i)for(var s=t.firstChild;s;){var u=s.nextSibling;r(s,e),s=u}}}function a(t,e,n){var o=b(t);if(void 0!==n)o.style[e]=n;else if(y(e))o.setAttribute("style",e);else for(var i in e)a(o,i,e[i])}function s(t,e,n){var o=b(t),i=o instanceof window.SVGElement;if(void 0!==n)"style"===e?a(o,n):i&&x(n)?o[e]=n:!i&&(e in o||x(n))?o[e]=n:o.setAttribute(e,n);else for(var r in e)s(o,r,e[r])}function u(t,n){for(var o=0;o<n.length;o++){var i=n[o];(0===i||i)&&("function"==typeof i?i(t):y(i)||w(i)?t.appendChild(m(i)):D(b(i))?e(t,i):i.length?u(t,i):"object"==typeof i&&s(t,i))}}function d(t){for(var e=arguments,n=[],o=arguments.length-1;o-- >0;)n[o]=e[o+1];var i;if(y(t))i=C(t).cloneNode(!1);else{if(!D(t))throw new Error("At least one argument required");i=t.cloneNode(!1)}return u(i,n),i}function l(t,o){if(void 0===o.length)return l(t,[o]);for(var i=b(t).firstChild,r=0;r<o.length;r++){var a=o[r];a&&(b(a)!==i?e(t,a,i):i=i.nextSibling)}for(;i;){var s=i.nextSibling;n(t,i),i=s}}function c(t,e,n,o){return new h(t,e,n,o)}function h(t,e,n,o){this.__redom_list=!0,this.View=e,this.key=n,this.initData=o,this.views=[],this.el=_(t),n&&(this.lookup={})}function f(t,e,n){return new S(t,e,n)}document&&document.createElement("p").style;var p="#".charCodeAt(0),v=".".charCodeAt(0),g=["onmount","onunmount"],m=function(t){return document.createTextNode(t)},_=function(t){return y(t)?d(t):b(t)},b=function(t){return t.nodeType&&t||!t.el&&t||b(t.el)},y=function(t){return"string"==typeof t},w=function(t){return"number"==typeof t},x=function(t){return"function"==typeof t},D=function(t){return t&&t.nodeType},k={},C=function(e){return k[e]||(k[e]=t(e))};d.extend=function(t){var e=C(t);return d.bind(this,e)};var E=d;h.extend=function(t,e,n,o){return h.bind(h,t,e,n,o)},c.extend=h.extend,h.prototype.update=function(t){void 0===t&&(t=[]);for(var e=this.View,n=this.key,o=x(n),i=this.initData,r=new Array(t.length),a=this.views,s=n&&{},u=n&&this.lookup,d=0;d<t.length;d++){var c=t[d],h=void 0;if(n){var f=o?n(c):c[n];h=r[d]=u[f]||new e(i,c,d,t),s[f]=h,h.__id=f}else h=r[d]=a[d]||new e(i,c,d,t);var p=h.el;p.__redom_list&&(p=p.el),p.__redom_view=h,h.update&&h.update(c,d,t)}l(this,r),n&&(this.lookup=s),this.views=r};var S=function(t,e,n){this.el=_(t),this.Views=e,this.initData=n};S.prototype.update=function(t,e){if(t!==this.route){var n=this.Views[t];this.view=n&&new n(this.initData,e),this.route=t,l(this.el,[this.view])}this.view&&this.view.update&&this.view.update(e,t)};var O=function(t,e,n){(t.el||t).dispatchEvent(new CustomEvent("redom",{detail:{type:e,data:n},bubbles:!0}))},A=function(t,e){(t.el||t).addEventListener("redom",function(t){var n=t.detail,o=n.type,i=n.data,r=e[o];r&&r(i,t)})},L=function(){var t=this;this.el=E(".menu-item"),this.el.onclick=function(e){O(t,"section",t.data.id)}};L.prototype.update=function(t){var e=t.name,n=t._current;this.el.textContent=e,n?this.el.classList.add("current"):this.el.classList.remove("current"),this.data=t};var N=function(){this.el=E(".menu",this.sections=c(".menu-items",L,"id"))};N.prototype.update=function(t){var e=t.sections,n=t.section;this.sections.update(e.map(function(t){return Object.assign({},t,{_current:n===t.id})})),this.data=t};var j=function(){this.el=E(".home",E("h1","Home"),E("p","Welcome to RE:DOM state handling example."),E("p",E("a",{href:"#info"},"Check out info section for some more info.")),E("p",E("a",{target:"_blank",href:"https://github.com/pakastin/redom-state"},"See source on Github!")))},T=function(){var t=this;this.el=E(".info",E("h1","RE:DOM state handling"),E("p","I like to do RE:DOM state handling so that I dispatch custom HTML event upstream and update RE:DOM components downstream.",E("br"),"To learn more how it works, check out Github repo: ",E("a",{target:"_blank",href:"https://github.com/pakastin/redom-state"},"https://github.com/pakastin/redom-state")),E("p","Turn on the debug mode, navigate around and see what happens under the hood:"),this.toggleDebug=E("button"),E("br"),this.toggleLogo=E("button"),E("br"),E("br"),this.logo=E("img",{src:"https://redom.js.org/img/logo.svg"}),E("br"),E("br"),E("p",E("i","ps. try refresh the page and see what happens ;)"))),this.toggleDebug.onclick=function(e){O(t,"toggle-debug")},this.toggleLogo.onclick=function(e){O(t,"toggle-logo")}};T.prototype.update=function(t){var e=t.debug,n=t.logo;this.toggleDebug.textContent=e?"Deactivate state debugging":"Activate state debugging",n?(this.toggleLogo.textContent="Hide logo",this.logo.style.display=""):(this.toggleLogo.textContent="Show logo",this.logo.style.display="none"),this.data=t};var R=function(){var t=this;this.el=E(".fiddle",E("h1","Try add some content"),this.form=E("form",this.type=E("select",E("option",{value:"h1"},"h1"),E("option",{value:"h2"},"h2"),E("option",{value:"p"},"p")),this.text=E("input",{autofocus:!0,placeholder:"text"}),E("button",{type:"submit"},"Add text"),E("br"),E("br"),this.editable=c(".editable",H,"id"))),this.form.onsubmit=function(e){e.preventDefault(),O(t,"add-text",{type:t.type.value,text:t.text.value}),t.text.value="",t.text.focus()}};R.prototype.update=function(t){var e=t.editable;this.editable.update(e),this.data=t};var H=function(t,e){var n=this;this.el=E(e.type,this.span=E("span"),this.remove=E("button","x")),this.remove.onclick=function(t){O(n,"remove-text",n.data.id)}};H.prototype.update=function(t){this.span.textContent=t.text,this.data=t};var I=function(){this.el=E(".content"),this.router=f(this.el,{"":j,info:T,fiddle:R})};I.prototype.update=function(t){var e=t.section;this.router.update(e,t)};var M=function(t){var e=this;this.el=E(".debug"),this.app=t,this.onDebug=function(t){var n=t.detail,o=n.data,i=n.type;o?e.log('{ "type": "'+i+'", data: "'+o+'" }'):e.log('{ "type": \''+i+'" }')},this.data={}};M.prototype.update=function(t){var e=t.debug;e?(this.el.style.display="",this.app.el.addEventListener("redom",this.onDebug)):(this.el.style.display="none",this.app.el.removeEventListener("redom",this.onDebug)),e!==!!this.data.debug&&this.log('{ "type": "toggle-debug" }'),this.data=t},M.prototype.log=function(t){e(this.el,E("p",Date.now()+" <- "+t)),e(this.el,E("p",Date.now()+" -> "+JSON.stringify(this.app.data,null," "))),e(this.el,E("br")),this.el.scrollTop=this.el.scrollHeight};var V=function(t){this.el=E(".app",this.menu=new N,this.content=new I,this.debug=new M(this)),this.data=t};V.prototype.update=function(){var t=this;this.rendering||(this.rendering=requestAnimationFrame(function(){t.rendering=null,t.menu.update(t.data),t.content.update(t.data),t.debug.update(t.data)}),window.localStorage&&window.localStorage.setItem("redom-state",JSON.stringify(this.data)))},V.prototype.recoverData=function(){var t=window.localStorage&&window.localStorage.getItem("redom-state");t&&(this.data=JSON.parse(t),this.update())};var G=Date.now(),J=new V({sections:[{id:"",name:"Home"},{id:"info",name:"Info"},{id:"fiddle",name:"Fiddle"}],editable:[]});e(document.body,J),function(t,e){var n=function(){var e=location.hash.slice(1).split("/");O(t,"route",e)},o={};for(var i in e)!function(n){o[n]=function(o,i){var r=e[n](t.data,o,i);r&&(t.data=r,t.update())}}(i);A(t,o),window.addEventListener("hashchange",n),t.startRoute=n}(J,function(){return{route:function(t,e){var n=e[0];return Object.assign({},t,{section:n})},section:function(t,e){var n=window.location.hash.slice(1).split("/");n[0]=e,window.location.hash=n.join("/")},"toggle-debug":function(t){var e=!t.debug;return Object.assign({},t,{debug:e})},"toggle-logo":function(t){var e=!t.logo;return Object.assign({},t,{logo:e})},"add-text":function(t,e){var n=e.type,o=e.text,i=t.editable;return Object.assign({},t,{editable:i.concat({id:G++,type:n,text:o})})},"remove-text":function(t,e){var n=t.editable;return Object.assign({},t,{editable:n.filter(function(t){return t.id!==e})})}}}()),J.recoverData(),J.startRoute()}();