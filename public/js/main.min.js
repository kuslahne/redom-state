!function(){"use strict";function t(t,e){for(var i,n,o,a=0,s=0,r=t.length,d=0;d<=r;d++){var u=t[d];if(u===l||u===h||null==u){if(0===a)i=0===d?"div":null==u?t:t.substring(s,d);else{var p=t.substring(s,d);1===a?n=p:o?o+=" "+p:o=p}s=d+1,a=u===l?1:2}}var c=e?document.createElementNS(e,i):document.createElement(i);return n&&(c.id=n),o&&(c.className=o),c}function e(t){return document.createTextNode(t)}function i(t,e,i){var n=t.el||t,o=e.el||e;o.__redom_list&&(o=o.el),e===o&&o.__redom_view&&(e=o.__redom_view),e!==o&&(o.__redom_view=e),e.isMounted?e.remount&&e.remount():e.mount&&e.mount(),i?n.insertBefore(o,i.el||i):n.appendChild(o),e.isMounted?e.remounted&&e.remounted():(e.isMounted=!0,e.mounted&&e.mounted())}function n(t,e){var i=t.el||t,n=e.el||e;e===n&&n.__redom_view&&(e=n.__redom_view),e.unmount&&e.unmount(),i.removeChild(n),e.isMounted=!1,e.unmounted&&e.unmounted()}function o(n){var o,a=arguments;if("string"==typeof n)o=(p[n]||(p[n]=t(n))).cloneNode(!1);else{if(!n||!n.nodeType)throw new Error("At least one argument required");o=n.cloneNode(!1)}for(var s=!0,r=1;r<arguments.length;r++){var d=a[r];if(d)if("function"==typeof d)d(o);else if("string"==typeof d||"number"==typeof d)s?(s=!1,o.textContent=d):o.appendChild(e(d));else if(d.nodeType||d.el&&d.el.nodeType)s=!1,i(o,d);else if(d.length){s=!1;for(var u=0;u<d.length;u++)i(o,d[u])}else if("object"==typeof d)for(var l in d){var h=d[l];if("style"===l)if("string"==typeof h)o.setAttribute(l,h);else for(var c in h)o.style[c]=h[c];else l in o||"function"==typeof h?o[l]=h:o.setAttribute(l,h)}}return o}function a(t,e){for(var o=t.el||t,a=o.firstChild,s=0;s<e.length;s++){var r=e[s];if(r){var d=r.el||r;d!==a?i(t,r,a):a=a.nextSibling}}for(;a;){var u=a.nextSibling;n(t,a),a=u}}function s(t,e,i,n){return new r(t,e,i,n)}function r(t,e,i,n){this.__redom_list=!0,this.View=e,this.key=i,this.initData=n,this.views=[],this.el="string"==typeof t?o(t):t,i&&(this.lookup={})}function d(t,e){return new c(t,e)}function u(n,o){var a,s=arguments;if("string"==typeof n)a=(g[n]||(g[n]=t(n,f))).cloneNode(!1);else{if(!n||!n.nodeType)throw new Error("At least one argument required");a=n.cloneNode(!1)}for(var r=!0,d=1;d<arguments.length;d++){var u=s[d];if(u)if("function"==typeof u)u=u(a);else if("string"==typeof u||"number"==typeof u)r?(r=!1,a.textContent=u):a.appendChild(e(u));else if(u.nodeType||u.el&&u.el.nodeType)r=!1,i(a,u);else if("object"==typeof u)for(var l in u){var h=u[l];if("style"===l&&"string"!=typeof h)for(var p in h)a.style[p]=h[p];else"function"==typeof h?a[l]=h:a.setAttribute(l,h)}}return a}var l="#",h=".",p={};o.extend=function(e){var i=p[e]||(p[e]=t(e));return o.bind(this,i)},r.extend=function(t,e,i,n){return r.bind(r,t,e,i,n)},s.extend=r.extend,r.prototype.update=function(t){for(var e=this.View,i=this.key,n="function"==typeof i,o=this.initData,s=new Array(t.length),r=this.views,d=i&&{},u=i&&this.lookup,l=0;l<t.length;l++){var h=t[l],p=void 0;if(i){var c=n?i(h):h[i];p=s[l]=u[c]||new e(o,h,l,t),d[c]=p,p.__id=c}else p=s[l]=r[l]||new e(o,h,l,t);var f=p.el;f.__redom_list&&(f=f.el),f.__redom_view=p,p.update&&p.update(h,l,t)}a(this,s),i&&(this.lookup=d),this.views=s};var c=function(t,e){this.el="string"==typeof t?o(t):t,this.Views=e};c.prototype.update=function(t,e){if(t!==this.route){var i=this.Views,n=i[t];this.view=n&&new n,this.route=t,a(this.el,[this.view])}this.view&&this.view.update&&this.view.update(e)};var f="http://www.w3.org/2000/svg",g={};u.extend=function(e){var i=g[e]||(g[e]=t(e,f));return u.bind(this,i)};var v=function(t,e,i){var n=t.el||t;n.dispatchEvent(new CustomEvent("redom",{detail:{type:e,data:i},bubbles:!0}))},m=function(t,e){var i=t.el||t;i.addEventListener("redom",function(t){var i=t.detail,n=i.type,o=i.data,a=e[n];a&&a(o,t)})},b=function(){var t=this;this.el=o(".menu-item"),this.el.onclick=function(e){v(t,"section",t.data.id)}};b.prototype.update=function(t){var e=t.name,i=t._current;this.el.textContent=e,i?this.el.classList.add("current"):this.el.classList.remove("current"),this.data=t};var y=function(){this.el=o(".menu",this.sections=s(".menu-items",b,"id"))};y.prototype.update=function(t){var e=t.sections,i=t.section;this.sections.update(e.map(function(t){return Object.assign({},t,{_current:i===t.id})})),this.data=t};var w=function(){this.el=o(".home",o("h1","Home"),o("p","Welcome to RE:DOM state handling example."),o("p",o("a",{href:"#info"},"Check out info section for some more info.")),o("p",o("a",{target:"_blank",href:"https://github.com/pakastin/redom-state"},"See source on Github!")))},x=function(){var t=this;this.el=o(".info",o("h1","RE:DOM state handling"),o("p","I like to do RE:DOM state handling so that I dispatch custom HTML event upstream and update RE:DOM components downstream."),o("p","Turn on the debug mode, navigate around and see what happens under the hood:"),this.toggleDebug=o("button"),o("br"),this.toggleLogo=o("button"),o("br"),o("br"),this.logo=o("img",{src:"https://redom.js.org/img/logo.svg"}),o("br"),o("br"),o("p",o("i","ps. try refresh the page and see what happens ;)"))),this.toggleDebug.onclick=function(e){v(t,"toggle-debug")},this.toggleLogo.onclick=function(e){v(t,"toggle-logo")}};x.prototype.update=function(t){var e=t.debug,i=t.logo;e?this.toggleDebug.textContent="Deactivate state debugging":this.toggleDebug.textContent="Activate state debugging",i?(this.toggleLogo.textContent="Hide logo",this.logo.style.display=""):(this.toggleLogo.textContent="Show logo",this.logo.style.display="none"),this.data=t};var _=function(){var t=this;this.el=o(".fiddle",o("h1","Try add some content"),this.form=o("form",this.type=o("select",o("option",{value:"h1"},"h1"),o("option",{value:"h2"},"h2"),o("option",{value:"p"},"p")),this.text=o("input",{autofocus:!0,placeholder:"text"}),o("button",{type:"submit"},"Add text"),o("br"),o("br"),this.editable=s(".editable",D,"id"))),this.form.onsubmit=function(e){e.preventDefault(),v(t,"add-text",{type:t.type.value,text:t.text.value}),t.text.value="",t.text.focus()}};_.prototype.update=function(t){var e=t.editable;this.editable.update(e),this.data=t};var D=function(t,e){var i=this;this.el=o(e.type,this.span=o("span"),this.remove=o("button","x")),this.remove.onclick=function(t){v(i,"remove-text",i.data.id)}};D.prototype.update=function(t){this.span.textContent=t.text,this.data=t};var C=function(){this.el=o(".content"),this.router=d(this.el,{"":w,info:x,fiddle:_})};C.prototype.update=function(t){var e=t.section;this.router.update(e,t)};var E=function(t){var e=this;this.el=o(".debug"),this.app=t,this.onDebug=function(t){var i=t.detail,n=i.data,o=i.type;n?e.log('{ "type": "'+o+'", data: "'+n+'" }'):e.log('{ "type": \''+o+'" }')},this.data={}};E.prototype.update=function(t){var e=t.debug;e?(this.el.style.display="",this.app.el.addEventListener("redom",this.onDebug)):(this.el.style.display="none",this.app.el.removeEventListener("redom",this.onDebug)),e!==!!this.data.debug&&(e?this.log('{ "type": "toggle-debug" }'):this.log('{ "type": "toggle-debug" }')),this.data=t},E.prototype.log=function(t){i(this.el,o("p","<- "+t)),i(this.el,o("p","-> "+JSON.stringify(this.app.data,null," "))),i(this.el,o("br")),this.el.scrollTop=this.el.scrollHeight};var k=function(t){this.el=o(".app",this.menu=new y,this.content=new C,this.debug=new E(this)),this.data=t};k.prototype.update=function(){this.menu.update(this.data),this.content.update(this.data),this.debug.update(this.data),window.localStorage&&window.localStorage.setItem("redom-state",JSON.stringify(this.data))},k.prototype.recoverData=function(){var t=window.localStorage&&window.localStorage.getItem("redom-state");t&&(this.data=JSON.parse(t),this.update())};var O=function(t,e){var i=function(){var e=location.hash.slice(1).split("/");v(t,"route",e)};m(t,e),window.addEventListener("hashchange",i),t.startRoute=i},S=Date.now(),L=function(t){return{route:function(e){var i=e[0];t.data=Object.assign({},t.data,{section:i}),t.update()},section:function(t){var e=window.location.hash.slice(1).split("/");e[0]=t,window.location.hash=e.join("/")},"toggle-debug":function(){var e=!t.data.debug;t.data=Object.assign({},t.data,{debug:e}),t.update()},"toggle-logo":function(){var e=!t.data.logo;t.data=Object.assign({},t.data,{logo:e}),t.update()},"add-text":function(e){var i=e.type,n=e.text;t.data=Object.assign({},t.data,{editable:t.data.editable.concat({id:S++,type:i,text:n})}),t.update()},"remove-text":function(e){t.data=Object.assign({},t.data,{editable:t.data.editable.filter(function(t){return t.id!==e})}),t.update()}}},T={sections:[{id:"",name:"Home"},{id:"info",name:"Info"},{id:"fiddle",name:"Fiddle"}],editable:[]},j=new k(T);i(document.body,j),O(j,L(j)),j.recoverData(),j.startRoute()}();
//# sourceMappingURL=main.map.js